#include <iostream>
#include <set>
#include <map>
#include <string>
#include <unordered_map>
#include <unordered_set>
using namespace std;

bool isPalindrome(string str)
{
    for (int i = 0, j = str.length() - 1; i < j; ++i, --j)
    {
        if (str[i] != str[j])
        {
            return false;
        }
    }

    return true;
}

string reverseString(string str)
{
    string s(str);
    for (int i = 0, j = str.length() - 1; i < j; ++i, --j)
    {
        swap(s[i], s[j]);
    }

    return s;
}

void findPairs(string a[], int n)
{
    unordered_map<string, int> m1;
    for (int i = 0; i < n; ++i)
    {
        m1[a[i]] = i;
    }

    map<int, unordered_set<int>> m2;
    for (int i = 0; i < n; ++i)
    {
        string reverse = reverseString(a[i]);
        if (m1.find(reverse) != m1.end() && m1[reverse] != i)
        {
            m2[i].insert(m1[reverse]);
        }

        for (int j = 1; j < reverse.length(); ++j)
        {
            string right = reverse.substr(j);
            if (isPalindrome(a[i] + right))
            {
                if (m1.find(right) != m1.end() && m1[right] != i)
                {
                    m2[i].insert(m1[right]);
                }
            }

            string left = reverse.substr(0, reverse.length() - j);
            if (isPalindrome(left + a[i]))
            {
                if (m1.find(left) != m1.end() && m1[left] != i)
                {
                    m2[m1[left]].insert(i);
                }
            }
        }
    }

    for (auto p : m2)
    {
        for (int i : p.second)
        {
            cout << a[p.first] << ", " << a[i] << endl;
        }
    }
}

void aaa(string a[], int n)
{
    for (int i = 0; i < n; ++i)
    {
        for (int j = 0; j < n; ++j)
        {
            if (i != j && isPalindrome(a[i] + a[j]))
            {
                cout << a[i] << ", " << a[j] << endl;
            }
        }
    }
}

int main()
{
    string a[] = {"abc", "cba", "ba", "a", "b", "aaa", "aa"};
    int n = sizeof(a) / sizeof(a[0]);

    findPairs(a, n);
    cout << "------" << endl;
    aaa(a, n);
}

/*

abc, cba
abc, ba
cba, abc
ba, b
a, ba
a, aaa
a, aa
aaa, aa
aaa, a
aa, aaa
aa, a
------
abc, cba
abc, ba
cba, abc
ba, b
a, ba
a, aaa
a, aa
aaa, a
aaa, aa
aa, a
aa, aaa

*/

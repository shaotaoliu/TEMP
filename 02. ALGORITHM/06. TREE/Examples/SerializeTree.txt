#include <iostream>
#include <vector>
#include <queue>
using namespace std;

struct Node
{
    char data;
    vector<Node*> child;

    Node(char c)
    {
        data = c;
    }
};

void serialize(Node *root, FILE *fp)
{
    if (root == NULL)
    {
        return;
    }

    fprintf(fp, "%c", root->data);

    for (int i = 0; i < root->child.size(); ++i)
    {
        serialize(root->child[i], fp);
    }

    fprintf(fp, "|");
}

Node *deserialize(FILE *fp)
{
    char val;
    if (!fscanf(fp, "%c", &val) || val == '|')
    {
        return NULL;
    }

    Node *root = new Node(val);

    while (Node *node = deserialize(fp))
    {
        root->child.push_back(node);
    }

    return root;
}

Node *createDummyTree()
{
    Node *root = new Node('A');
    root->child.push_back(new Node('B'));
    root->child.push_back(new Node('C'));
    root->child.push_back(new Node('D'));
    root->child[0]->child.push_back(new Node('E'));
    root->child[0]->child.push_back(new Node('F'));
    root->child[2]->child.push_back(new Node('G'));
    root->child[2]->child.push_back(new Node('H'));
    root->child[2]->child.push_back(new Node('I'));
    root->child[2]->child.push_back(new Node('J'));
    root->child[0]->child[1]->child.push_back(new Node('K'));
    return root;
}

void traverse(Node *root)
{
    if (root == NULL)
    {
        return;
    }

    printf("%c ", root->data);

    for (int i = 0; i < root->child.size(); ++i)
    {
        traverse(root->child[i]);
    }
}

int main()
{
    Node *root = createDummyTree();

    FILE *fp = fopen("tree.txt", "w");
    serialize(root, fp);
    fclose(fp);

    fp = fopen("tree.txt", "r");
    Node *node = deserialize(fp);
    traverse(node);
}

/*

A B E F K C D G H I J

*/
